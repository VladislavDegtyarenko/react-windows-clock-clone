import{r as p}from"./react.e158b38e.js";import{n as H}from"./nanoid.1d085756.js";import{b as q,j as n,a as w,C as E,M as J,c as Y,d as G,e as Q,N as X,F as Z,A as ee,f as te}from"./AlarmApp.jsx.16154191.js";import{C as ne,h as re,E as B,I as ie,B as O,P as oe,b as se,g as ae,D as ce,e as ue,T as le}from"./@fluentui.dcb38d1f.js";import{D as de}from"./StopwatchApp.jsx.cdd8706c.js";const j=p.exports.createContext(null);let C;const Ve=({children:r})=>{const t=p.exports.useContext(q),o=({title:e,text:d})=>new Notification(e,{body:d,requireInteraction:!0}),s=({title:e,text:d,soundTitle:u,loop:_})=>{"Notification"in window?Notification.permission==="granted"?(C=o({title:e,text:d}),u&&t.play({soundTitle:u,loop:_})):Notification.permission!=="denied"&&Notification.requestPermission().then(m=>{m==="granted"&&(C=o({title:e,text:d}),u&&t.play({soundTitle:u,loop:_}))}):alert("This browser does not support desktop notification")};p.exports.useEffect(()=>{C&&(C.onclick=()=>{t.stop(),C=null},C.addEventListener("close",()=>{t.stop(),C=null}))},[C]);const a={show:s};return n(j.Provider,{value:a,children:r})},me="_digits_1f1ne_1";var V={digits:me};const pe=300,_e=50;let b,R;function U({inputSettings:r,handleArrowUpKey:t,handleArrowDownKey:o,handleDigitKeyPress:s}){const[a,e]=p.exports.useState(!1);p.exports.useEffect(()=>(a&&(document.addEventListener("mouseup",m,{once:!0}),document.addEventListener("touchend",m,{once:!0})),()=>{document.removeEventListener("mouseup",m),document.removeEventListener("touchend",m)}),[a]);const d=i=>{const T=i.key==="ArrowUp",v=i.key==="ArrowDown",M=!isNaN(i.key);b||R||(T&&u(t),v&&u(o),M&&s&&s(i))},u=i=>{!i||(e(!0),i(),b=setTimeout(()=>_(i),pe))},_=i=>{i(),R=setTimeout(()=>_(i),_e)},m=()=>{clearTimeout(b),clearTimeout(R),b=null,R=null,e(!1)},h=i=>{(i.key==="ArrowUp"||i.key==="ArrowDown")&&m()};return w("div",{className:V.digits,children:[n(E,{onMouseDown:i=>{i.preventDefault(),i.stopPropagation(),i.returnValue=!1,u(t)},onTouchStart:i=>{i.stopPropagation(),i.returnValue=!1,u(t)},onContextMenu:i=>i.preventDefault(),appearance:"subtle",icon:n(ne,{}),tabIndex:-1}),n("input",{...r,onKeyDown:d,onKeyUp:h,onContextMenu:i=>i.preventDefault()}),n(E,{onMouseDown:i=>{i.preventDefault(),i.stopPropagation(),i.returnValue=!1,u(o)},onTouchStart:i=>{i.stopPropagation(),i.returnValue=!1,u(o)},onContextMenu:i=>i.preventDefault(),appearance:"subtle",icon:n(re,{}),tabIndex:-1})]})}function fe({id:r,value:t,minValue:o,maxValue:s,inputRef:a}){const[e,d]=p.exports.useState(t),u=()=>{d(T=>T+1>s?o:++T)},_=()=>{d(T=>T-1<o?s:--T)},m=T=>{const v=T.key;d(M=>{const N=+(String(M).slice(-1)+v);return N<s?N:v})},i={id:r,type:"number",min:o,max:s,readOnly:!0,value:(T=>T<10?"0"+T:T)(e),ref:a};return n(U,{handleArrowUpKey:u,handleArrowDownKey:_,handleDigitKeyPress:m,inputSettings:i})}function ge({id:r,checked:t,inputRef:o,onChange:s}){const[a,e]=p.exports.useState(t),d=()=>{e(_=>!_)},u={id:r,type:"checkbox",readOnly:!0,checked:a,className:V.ampm,ref:o};return n(U,{handleArrowUpKey:d,handleArrowDownKey:d,inputSettings:u})}const Te="_TimeInputMenu_bkx4m_1",he="_TimeInputMenu__inner_bkx4m_13";var $={TimeInputMenu:Te,TimeInputMenu__inner:he};const K=({timeInputs:r,timeRef:t})=>{const o=p.exports.useRef(),s=e=>document.activeElement===e,a=e=>e==null?void 0:e.focus();return p.exports.useEffect(()=>{o.current.addEventListener("keydown",e=>{const d=e.key==="ArrowLeft",u=e.key==="ArrowRight";if(!d&&!u)return;const _=t.hours.current,m=t.minutes.current,h=t.ampm.current;d&&(s(m)&&a(_),s(h)&&a(m)),u&&(s(m)&&a(h),s(_)&&a(m))})},[]),n("div",{className:$.TimeInputMenu,ref:o,onMouseDown:e=>{e.returnValue=!1},onTouchStart:e=>{e.returnValue=!1},onContextMenu:e=>e.preventDefault(),children:n("div",{className:$.TimeInputMenu__inner,children:r.map(({id:e,value:d,checked:u,minValue:_,maxValue:m})=>e==="ampm"?n(ge,{id:e,checked:u,inputRef:t[e]},e):n(fe,{id:e,value:d,minValue:_,maxValue:m,inputRef:t[e]},e))})})};var Ue=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"})),A={"input-container":"_input-container_13mt4_1","input-container__input":"_input-container__input_13mt4_17","input-container__img":"_input-container__img_13mt4_43"};function F({id:r,text:t,className:o,inputRef:s}){return w("div",{className:`${A["input-container"]} ${o}`,children:[n("div",{className:A["input-container__img"],children:n(B,{})}),n(ie,{id:r||"",defaultValue:t||"",className:A["input-container__input"],placeholder:"Enter your text here...",ref:s})]})}var Ke=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));function L({id:r,title:t,name:o,time:s=0,onSave:a,onCancel:e,deleteTimer:d}){const u=p.exports.useRef(),_=p.exports.useRef(),m=p.exports.useRef(),h=p.exports.useRef(),i={hours:u,minutes:_,seconds:m},[T,v]=p.exports.useState([{id:"hours",value:Math.floor(s/1e3/60/60),minValue:0,maxValue:99},{id:"minutes",value:Math.floor(s/1e3/60)%60,minValue:0,maxValue:59},{id:"seconds",value:Math.floor(s/1e3)%60,minValue:0,maxValue:59}]),M=(N,P)=>{v(D=>D.map(S=>S.id===N?{...S,value:P}:S))};return p.exports.useEffect(()=>{u.current.focus()},[]),w(J,{title:t,onDelete:()=>d(r),onSave:()=>a({id:r,name:h.current.value,timeRef:i}),onCancel:e,children:[n(K,{time:s,timeRef:i,timeInputs:T,onChange:M}),n(F,{id:"Timer Name",text:o,inputRef:h})]})}const we=()=>{let t;const o=a=>{a.time=s(a.time),a.time<=0&&(clearInterval(t),a.isRunning=!1),self.postMessage(a)},s=a=>a>0?a-100:0;self.onmessage=({data:a})=>{clearInterval(t),a.isRunning&&(a.time<=0||(t=setInterval(()=>o(a),100)))}};let I=we.toString();I=I.substring(I.indexOf("{")+1,I.lastIndexOf("}"));const ye=new Blob([I],{type:"application/javascript"}),ve=URL.createObjectURL(ye),z=p.exports.createContext(null),xe=[{id:1,name:"5 minutes",isRunning:!1,initialTime:3e5,worker:null},{id:2,name:"10 minutes",isRunning:!1,initialTime:6e5,worker:null}],Fe=r=>{const[t,o]=p.exports.useState(JSON.parse(localStorage.getItem("timers"))||xe),s="Echo",{openModal:a,closeModal:e}=p.exports.useContext(Y),d=p.exports.useContext(j);p.exports.useEffect(()=>{const l=t.map(({worker:f,...c})=>c);localStorage.setItem("timers",JSON.stringify(l)),t.length===0&&S(!1)},[t]);const u=l=>{o(f=>f.map(c=>{if(c.id!==l||c.worker)return c;const g=new Worker(ve);return g.onmessage=({data:x})=>m(x),{...c,worker:g}}))},_=l=>{o(f=>f.map(c=>{if(c.id!==l)return c;let g={isRunning:!c.isRunning,time:c.time||c.initialTime};return c.worker.postMessage({...g,id:l}),{...c,...g}}))},m=({id:l,time:f,isRunning:c})=>{if(console.log(f),o(g=>g.map(x=>x.id===l?{...x,time:f,isRunning:c}:x)),f===0){const g=t.filter(k=>k.id===l)[0].name,x=new Date().toLocaleTimeString("en",{timeStyle:"short"});d.show({title:"Timer done!",text:`${g}
${x}`,soundTitle:s,loop:!0})}},h=l=>{o(f=>f.map(c=>{if(c.id!==l)return c;let g={isRunning:c.isRunning,time:c.initialTime};return c.worker.postMessage({...g,id:l}),{...c,...g}}))},i=({id:l,name:f,timeRef:c})=>{const g=v(c);o(x=>x.map(k=>k.id===l?{...k,name:f,time:g,initialTime:g,isRunning:!1}:k)),h(l),e()},T=l=>{t[l].worker.terminate(),o(f=>f.filter(c=>c.id!==l)),e()},v=l=>{const f=l.hours.current.value*1e3*60*60,c=l.minutes.current.value*1e3*60,g=l.seconds.current.value*1e3;return f+c+g},M=({id:l,name:f,initialTime:c})=>{a(n(L,{id:l,title:"Edit timer",name:f,time:c,onSave:i,onCancel:e,deleteTimer:T}))},N=()=>{a(n(L,{title:"Add new timer",onSave:P,onCancel:e}))},P=({name:l,timeRef:f})=>{const c=v(f);o(g=>[...g,{id:H(),name:l,time:c,initialTime:c,isRunning:!1,worker:null}]),e()},[D,S]=p.exports.useState(!1),W={timers:t,actions:{initTimerWorker:u,toggleStartTimer:_,tickTimer:m,resetTimer:h,editTimer:M,closeModal:e,saveTimerChanges:i,deleteTimer:T,setTimers:o,openAddNewTimerModal:N,toggleEditTimers:()=>S(l=>!l)},editingState:D,timerSoundTitle:s};return n(z.Provider,{value:W,children:r.children})},Ce="_TimerModalContent_1r8yo_231",Me="_edit_1r8yo_239";var y={"timer-card":"_timer-card_1r8yo_1","timer-card__title":"_timer-card__title_1r8yo_25","timer-card__main":"_timer-card__main_1r8yo_43","timer-card__info":"_timer-card__info_1r8yo_51","timer-card__controls":"_timer-card__controls_1r8yo_67","timer-card__btn":"_timer-card__btn_1r8yo_127","timer-card__circle":"_timer-card__circle_1r8yo_155","timer-card__circle_elapsed":"_timer-card__circle_elapsed_1r8yo_181","timer-card__circle_remaining":"_timer-card__circle_remaining_1r8yo_193","timer-card__digits":"_timer-card__digits_1r8yo_215",TimerModalContent:Ce,edit:Me};function Ne({timer:{isRunning:r,time:t,initialTime:o},CONSTANTS:{FULL_DASH_ARRAY:s,TIMER_STEP:a}}){const e=()=>t/o,d=()=>`${Math.round(e()*s)||0} ${s}`,u={display:`${e()===1?"none":""} `,opacity:`${!r&&t>0?"0.5":""}`,transition:`all ${a/1e3}s ease-in`};return n("svg",{className:y["timer-card__circle"],viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",children:w("g",{children:[n("circle",{className:y["timer-card__circle_elapsed"],cx:"50",cy:"50",r:"45"}),n("path",{strokeDasharray:d(),className:y["timer-card__circle_remaining"],style:u,d:"\r M 50, 50\r m -45, 0\r a 45,45 0 1,0 90,0\r a 45,45 0 1,0 -90,0\r "})]})})}function Se({time:r=0,isActive:t}){return n("div",{className:y["timer-card__digits"],children:n(de,{time:r,isActive:t})})}const ke={TIMER_STEP:100,FULL_DASH_ARRAY:283};function Ie({timer:r,refs:t,toggleStartTimer:o,resetTimer:s,timerEditingState:a}){return w("main",{className:y["timer-card__main"],ref:t||null,children:[w("div",{className:y["timer-card__info"],children:[n(Ne,{timer:r,CONSTANTS:ke}),n(Se,{time:r.time||r.initialTime,isActive:r.isRunning})]}),w("div",{className:y["timer-card__controls"],children:[n(O,{onClick:e=>{e.stopPropagation(),o(r.id)},icon:r.isRunning?n(oe,{}):n(se,{}),appearance:"primary",shape:"circular",disabled:a||r.initialTime===0}),n(O,{onClick:e=>{e.stopPropagation(),s(r.id)},icon:n(ae,{}),appearance:"secondary",shape:"circular",disabled:a||r.time===r.initialTime&&!r.isRunning})]})]})}function be({timer:r,timerActions:{initTimerWorker:t,toggleStartTimer:o,resetTimer:s,editTimer:a,saveTimerChanges:e,closeModal:d,deleteTimer:u},timerEditingState:_}){return p.exports.useEffect(()=>{t(r.id)},[]),w(G,{className:`${y["timer-card"]} ${_?y.edit:""}`,onClick:()=>a(r),children:[w("header",{children:[n("h3",{className:y["timer-card__title"],children:r.name}),_?n(O,{onClick:m=>{m.stopPropagation(),u(r.id)},icon:n(ce,{}),appearance:"subtle"}):null]}),n(Ie,{timer:r,toggleStartTimer:o,resetTimer:s,timerEditingState:_})]})}function Re({openAddNewTimerModal:r,toggleEditTimers:t}){return w(Q,{children:[n(E,{appearance:"subtle",size:"large",icon:n(B,{}),onClick:t}),n(E,{appearance:"subtle",size:"large",icon:n(ue,{}),onClick:r})]})}function Ee(){return n(X,{icon:n(le,{}),title:"You don't have any timers.",description:'Select "+" below to add a new timer.'})}const Pe=()=>{const{timers:r,actions:t,editingState:o}=p.exports.useContext(z);return w(Z,{children:[n(ee,{motionDivKey:"timer",children:n(te,{children:r&&r.length>0?r.map(s=>n(be,{id:s.id,timer:s,timerActions:t,timerEditingState:o},s.id)):n(Ee,{})})}),n(Re,{openAddNewTimerModal:t.openAddNewTimerModal,toggleEditTimers:t.toggleEditTimers})]})};var ze=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));export{Ve as N,Fe as T,Ke as a,ze as b,Ue as i};
